<!doctype html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#faf7f0" media="(prefers-color-scheme: light)" />
  <meta name="theme-color" content="#0d1117" media="(prefers-color-scheme: dark)" />
  <title>廢星牧魂者</title>
  <link rel="icon" type="image/png" href="assets/favicon.png" />
  <link rel="apple-touch-icon" href="assets/icon-192.png" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
  <script src="app.js" defer></script>
</head>

<body>
  <div id="reading-progress"></div>

  <div class="app">
    <div class="sidebar-overlay"></div>
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title-row">
          <h1>廢星牧魂者</h1>
          <button id="sidebar-close-btn" type="button" class="icon-btn" aria-label="收起目錄">
            <svg viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
            </svg>
          </button>
        </div>
        <p class="subtitle">Ratforge: Soul Shepherd</p>
      </div>

      <div class="search-wrap">
        <input id="search-input" type="search" placeholder="搜尋章節..." />
        <svg viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
        </svg>
      </div>

      <nav id="chapter-list" class="chapter-list">
        <!-- Chapter list populated by JS -->
      </nav>

      <div class="sidebar-footer">
        <span id="status">載入中...</span>
        <span id="word-count"></span>
      </div>
    </aside>

    <main class="main-wrapper">
      <div class="reader">
        <header class="top-nav">
          <div class="nav-left">
            <button id="menu-btn" type="button" class="icon-btn" aria-label="目錄">
              <svg viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              </svg>
            </button>
            <h2 id="chapter-title" class="chapter-title">請選擇章節</h2>
          </div>

          <div class="nav-controls">
            <button id="tts-toggle" type="button" class="icon-btn" aria-label="朗讀模式">
              <svg viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z" />
              </svg>
            </button>
            <button id="theme-toggle" type="button" class="icon-btn" aria-label="切換主題">
              <svg class="sun-icon" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
              </svg>
            </button>
            <button id="font-size-dec" type="button" class="icon-btn" aria-label="縮小字體">
              <svg viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15" />
              </svg>
            </button>
            <button id="font-size-inc" type="button" class="icon-btn" aria-label="放大字體">
              <svg viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
            </button>
            <button id="bookmark-btn" type="button" class="icon-btn" aria-label="加入書籤">
              <svg viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z" />
              </svg>
            </button>
          </div>
        </header>

        <article id="content" class="content">
          <p>正在準備內容...</p>
        </article>

        <div class="bottom-nav">
          <button id="prev-btn" class="nav-btn" type="button" disabled>
            <svg style="width:16px;height:16px" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
            </svg>
            上一章
          </button>
          <button id="next-btn" class="nav-btn" type="button" disabled>
            下一章
            <svg style="width:16px;height:16px" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Bottom Settings Panel -->
      <div class="bottom-panel-overlay"></div>
      <div id="bottom-panel" class="bottom-panel">
        <div class="bottom-panel-handle"></div>

        <!-- TTS Section -->
        <div class="panel-section">
          <h3>🔊 聽書模式</h3>
          <div class="tts-controls">
            <button id="tts-panel-toggle" class="panel-btn tts-play-btn">
              ▶ 開始朗讀
            </button>
            <button id="tts-stop-btn" class="panel-btn">⏹</button>
          </div>
          <div class="tts-settings">
            <div class="tts-rate-row">
              <label>語速</label>
              <input id="tts-rate" type="range" min="0.5" max="2.0" step="0.1" value="1.0">
              <span id="tts-rate-label">1.0x</span>
            </div>
            <div class="tts-start-from">
              <label>從哪裡開始</label>
              <select id="tts-start-select">
                <option value="beginning">📖 從本章開頭</option>
                <option value="current" selected>📍 從目前段落</option>
                <option value="bookmark">🔖 從書籤處</option>
              </select>
            </div>
          </div>
        </div>

        <div class="panel-divider"></div>

        <!-- Reading Settings -->
        <div class="panel-section">
          <h3>⚙️ 閱讀設定</h3>
          <div class="setting-row">
            <span>字體大小</span>
            <div class="font-size-control">
              <button id="panel-font-dec" class="panel-btn small">A-</button>
              <span id="panel-font-label">1.1</span>
              <button id="panel-font-inc" class="panel-btn small">A+</button>
            </div>
          </div>
          <div class="setting-row">
            <span>主題</span>
            <button id="panel-theme-toggle" class="panel-btn">🌙 切換主題</button>
          </div>
        </div>
      </div>
    </main>
  </div>
</body>

</html>